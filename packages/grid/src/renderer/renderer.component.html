<ko-stage
    [config]="stageConfig()"
    (koMousemove)="stageMousemove($event)"
    (koMousedown)="stageMousedown($event)"
    (koClick)="stageClick($event)"
    (koDblclick)="stageDblclick($event)"
>
    <ko-layer>
        <ko-group [config]="gridGroupConfig()">
            <ko-group [config]="offsetYConfig()">
                <ai-table-frozen-cells [options]="cellsOptions()"></ai-table-frozen-cells>
                <ai-table-other-rows [options]="cellsOptions()"></ai-table-other-rows>
                <ai-table-hover-row-heads [options]="cellsOptions()"></ai-table-hover-row-heads>
                <ai-table-frozen-placeholder-cells [options]="cellsOptions()"></ai-table-frozen-placeholder-cells>
            </ko-group>

            <ko-group>
                <ai-table-frozen-column-heads [options]="columnHeadOptions()"></ai-table-frozen-column-heads>
            </ko-group>

            <ko-group [config]="commonGroupConfig()">
                <ko-group [config]="offsetConfig()">
                    <ai-table-cells [options]="cellsOptions()"></ai-table-cells>
                </ko-group>

                <ko-group [config]="offsetXConfig()">
                    <ai-table-column-heads [options]="columnHeadOptions()"></ai-table-column-heads>
                    <ai-table-add-field
                        [coordinate]="coordinate()"
                        [fields]="fields()"
                        [columnStopIndex]="visibleRangeInfo().columnStopIndex"
                    ></ai-table-add-field>
                </ko-group>
            </ko-group>

            <ko-group [config]="attachGroupConfig()">
                <ko-group [config]="offsetConfig()">
                    <ai-table-placeholder-cells [options]="cellsOptions()"></ai-table-placeholder-cells>
                    @if (activeCellBorderOptions().activeCellBorder) {
                        <ko-rect [config]="activeCellBorderOptions().activeCellBorder!"></ko-rect>
                    }
                </ko-group>
            </ko-group>

            <ko-group [config]="frozenAttachGroupConfig()">
                <ko-group [config]="offsetYConfig()">
                    @if (activeCellBorderOptions().frozenActiveCellBorder) {
                        <ko-rect [config]="activeCellBorderOptions().frozenActiveCellBorder!"></ko-rect>
                    }
                </ko-group>
            </ko-group>
        </ko-group>
    </ko-layer>
</ko-stage>

<ng-content></ng-content>
